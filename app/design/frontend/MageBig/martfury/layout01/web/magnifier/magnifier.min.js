!function(n){function e(e,i){var a,t=i||{},o=n(e),s=this,r=i.largeWrapper||".magnifier-preview",m=n(r);curThumb=null,magnifierOptions={x:0,y:0,w:0,h:0,lensW:0,lensH:0,lensBgX:0,lensBgY:0,largeW:0,largeH:0,largeL:0,largeT:0,zoom:2,zoomMin:1.1,zoomMax:5,mode:"outside",eventType:"click",status:0,zoomAttached:!1,zoomable:void 0!==t.zoomable&&t.zoomable,onthumbenter:void 0!==t.onthumbenter?t.onthumbenter:null,onthumbmove:void 0!==t.onthumbmove?t.onthumbmove:null,onthumbleave:void 0!==t.onthumbleave?t.onthumbleave:null,onzoom:void 0!==t.onzoom?t.onzoom:null},pos={t:0,l:0,x:0,y:0},gId=0,status=0,curIdx="",curLens=null,curLarge=null,lensbg=void 0===t.bg||t.lensbg,gZoom=void 0!==t.zoom?t.zoom:magnifierOptions.zoom,gZoomMin=void 0!==t.zoomMin?t.zoomMin:magnifierOptions.zoomMin,gZoomMax=void 0!==t.zoomMax?t.zoomMax:magnifierOptions.zoomMax,gMode=t.mode||magnifierOptions.mode,gEventType=t.eventType||magnifierOptions.eventType,data={},inBounds=!1,isOverThumb=!1,rate=1,paddingX=0,paddingY=0,enabled=!0,showWrapper=!0;var g={magnifyHidden:"magnify-hidden",magnifyOpaque:"magnify-opaque",magnifyFull:"magnify-fullimage"};function l(n){if("string"==typeof n){if("true"===n)return!0;if("false"===n)return!1;console.warn("Wrong type: can't be transformed to Boolean")}else if("boolean"==typeof n)return n}function u(e,i,t,s){var r,m=o.find(".magnify-lens");1===data[e].status?(r=n('<div class="magnifier-loader-text"></div>'),m.className="magnifier-loader magnify-hidden",r.html("Loading..."),m.html("").append(r)):2===data[e].status&&(m.addClass(g.magnifyHidden),m.html(""),t.id=e+"-large",t.style.width=data[e].largeImgInMagnifyLensWidth+"px",t.style.height=data[e].largeImgInMagnifyLensHeight+"px",t.className="magnifier-large magnify-hidden","inside"===data[e].mode?m.append(t):s.html("").append(t)),data[e].lensH=data[e].lensH>a.height()?a.height():data[e].lensH,0===Math.round(data[e].lensW)?m.css("display","none"):m.css({width:Math.round(data[e].lensW)+"px",height:Math.round(data[e].lensH)+"px",display:""})}function d(){var n,e,i=pos.x-magnifierOptions.x,a=pos.y-magnifierOptions.y;inBounds=!(i<0||a<0||i>magnifierOptions.w||a>magnifierOptions.h),e=i-magnifierOptions.lensW/2,n=a-magnifierOptions.lensH/2,i<magnifierOptions.lensW/2&&(e=0),a<magnifierOptions.lensH/2&&(n=0),i-magnifierOptions.w+Math.ceil(magnifierOptions.lensW/2)>0&&(e=magnifierOptions.w-Math.ceil(magnifierOptions.lensW+2)),a-magnifierOptions.h+Math.ceil(magnifierOptions.lensH/2)>0&&(n=magnifierOptions.h-Math.ceil(magnifierOptions.lensH)),pos.l=e,pos.t=n,magnifierOptions.lensBgX=pos.l,magnifierOptions.lensBgY=pos.t,"inside"===magnifierOptions.mode?(magnifierOptions.largeL=Math.round(i*(magnifierOptions.zoom-magnifierOptions.lensW/magnifierOptions.w)),magnifierOptions.largeT=Math.round(a*(magnifierOptions.zoom-magnifierOptions.lensH/magnifierOptions.h))):(magnifierOptions.largeL=Math.round(magnifierOptions.lensBgX*magnifierOptions.zoom*(magnifierOptions.largeWrapperW/magnifierOptions.w)),magnifierOptions.largeT=Math.round(magnifierOptions.lensBgY*magnifierOptions.zoom*(magnifierOptions.largeWrapperH/magnifierOptions.h)))}function p(){l(enabled)&&(magnifierOptions=data[curIdx],curLens=o.find(".magnify-lens"),2===magnifierOptions.status?(curLens.removeClass(g.magnifyOpaque),curLarge=n("#"+curIdx+"-large"),curLarge.removeClass(g.magnifyHidden)):1===magnifierOptions.status&&(curLens.className="magnifier-loader"))}function f(){if(magnifierOptions.status>0){var n=magnifierOptions.onthumbleave;null!==n&&n({thumb:curThumb,lens:curLens,large:curLarge,x:pos.x,y:pos.y}),curLens.hasClass(g.magnifyHidden)||(curLens.addClass(g.magnifyHidden),null!==curLarge&&curLarge.addClass(g.magnifyHidden))}}function h(){if(l(enabled)){if(status!==magnifierOptions.status&&p(),magnifierOptions.status>0){curThumb.className=magnifierOptions.thumbCssClass+" magnify-opaque",1===magnifierOptions.status?curLens.className="magnifier-loader":2===magnifierOptions.status&&(curLens.removeClass(g.magnifyHidden),curLarge.removeClass(g.magnifyHidden),curLarge.css({left:"-"+magnifierOptions.largeL+"px",top:"-"+magnifierOptions.largeT+"px"}));pos.t=pos.t<=0?0:pos.t-2,curLens.css({left:pos.l+paddingX+"px",top:pos.t+paddingY+"px"}),lensbg?curLens.css({"background-color":"rgba(f,f,f,.5)"}):curLens.get(0).style.backgroundPosition="-"+magnifierOptions.lensBgX+"px -"+magnifierOptions.lensBgY+"px";var n=magnifierOptions.onthumbmove;null!==n&&n({thumb:curThumb,lens:curLens,large:curLarge,x:pos.x,y:pos.y})}status=magnifierOptions.status}}function c(n,e){var i=n.getBoundingClientRect(),a=0,t=0;e.x=Math.round(i.left),e.y=Math.round(i.top),e.w=Math.round(i.right-e.x),e.h=Math.round(i.bottom-e.y),"inside"===e.mode?(a=e.w,t=e.h):(a=e.largeWrapperW,t=e.largeWrapperH),e.largeImgInMagnifyLensWidth=Math.round(e.zoom*a),e.largeImgInMagnifyLensHeight=Math.round(e.zoom*t),e.lensW=Math.round(e.w/e.zoom),e.lensH=Math.round(e.h/e.zoom)}function v(e,i){var o={};if(void 0===i.thumb)return!1;if((a=e.find(i.thumb)).length){for(var r in i)o[r]=i[r];o.thumb=a,enabled=o.enabled,l(enabled)?(m.show().css("display",""),m.addClass(g.magnifyHidden),function(e){if(void 0!==data[e.thumb.id])return curThumb=e.thumb,!1;var i,a=new Image,o=new Image,s=e.thumb,r=s.get(0),m=r.id,g=n(e.largeWrapper),l=e.zoom||r.getAttribute("data-zoom")||gZoom,d=e.zoomMin||gZoomMin,p=e.zoomMax||gZoomMax,h=e.mode||r.getAttribute("data-mode")||gMode,v=e.eventType||r.getAttribute("data-eventType")||gEventType,O=void 0!==e.onthumbenter?e.onthumbenter:magnifierOptions.onthumbenter,y=void 0!==e.onthumbleave?e.onthumbleave:magnifierOptions.onthumbleave,x=void 0!==e.onthumbmove?e.onthumbmove:magnifierOptions.onthumbmove;i=s.data("original")||t.full||s.attr("src"),""===r.id&&(m=r.id="magnifier-item-"+gId,gId+=1);(function(e){if(n(e).siblings(".magnify-lens").length)return!1;var i=n('<div class="magnify-lens magnify-hidden" data-gallery-role="magnifier-zoom"></div>');n(e).parent().append(i)})(r),e.width&&g.width(e.width);e.height&&g.height(e.height);if(e.top){if("function"==typeof e.top)var M=e.top()+"px";else var M=e.top+"px";g.length&&(g[0].style.top=M.replace("%px","%"))}if(e.left){if("function"==typeof e.left)var z=e.left()+"px";else var z=e.left+"px";g.length&&(g[0].style.left=z.replace("%px","%"))}data[m]={zoom:l,zoomMin:d,zoomMax:p,mode:h,eventType:v,thumbCssClass:r.className,zoomAttached:!1,status:0,largeUrl:i,largeWrapperId:"outside"===h?g.attr("id"):null,largeWrapperW:"outside"===h?g.width():null,largeWrapperH:"outside"===h?g.height():null,onthumbenter:O,onthumbleave:y,onthumbmove:x},paddingX=(s.parent().width()-s.width())/2,paddingY=(s.parent().height()-s.height())/2,showWrapper=!1,n(a).on("load",function(){void 0!==data[m]&&(data[m].status=1,n(o).on("load",function(){(o.width>g.width()||o.height>g.height())&&void 0!==data[m]&&(showWrapper=!0,function(e,i){switch(e){case"hover":!function(e){n(e).on("mouseover",function(n){showWrapper&&(0!==magnifierOptions.status&&f(),b(n),isOverThumb=inBounds)})}(i);break;case"click":!function(e){n(e).on("click",function(n){showWrapper&&(isOverThumb||(0!==magnifierOptions.status&&f(),b(n),isOverThumb=!0))})}(i)}}(v,r),data[m].status=2,o.width>o.height?data[m].zoom=o.width/g.width():data[m].zoom=o.height/g.height(),c(r,data[m]),u(m,0,o,g))}),o.src=data[m].largeUrl)}),a.src=r.src}(o)):m.empty().hide()}return s}function b(n){var e=n.target;curIdx=e.id,curThumb=e,p(),c(curThumb,magnifierOptions),pos.x=n.clientX,pos.y=n.clientY,d(),h();var i=magnifierOptions.onthumbenter;null!==i&&i({thumb:curThumb,lens:curLens,large:curLarge,x:pos.x,y:pos.y})}s.update=function(){u()},s.init=function(){v(o,i)},n(window).on("scroll",function(){null!==curThumb&&c(curThumb,magnifierOptions)}),n(window).resize(function(){v(o,t)}),o.on("mousemove",function(n){pos.x=n.clientX,pos.y=n.clientY,d(),"hover"===gEventType&&(isOverThumb=inBounds),inBounds&&isOverThumb&&"outside"===gMode&&(m.removeClass(g.magnifyHidden),h())}),o.on("mouseleave",function(){f(),isOverThumb=!1,m.addClass(g.magnifyHidden)}),v(o,t)}n.fn.magnify=function(i){"use strict";return new e(n(this),i)}}(jQuery);